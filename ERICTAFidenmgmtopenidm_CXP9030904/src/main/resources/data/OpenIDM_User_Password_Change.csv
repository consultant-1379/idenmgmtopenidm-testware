step,host,command,args,expectedOut,expectedExit,timeout
Obtain a cookie for openidmtafjohn on SC1 before performing operations,sc1,curl,"-c /tmp/openidmtafjohnTafCookie.txt --cacert /ericsson/tor/data/certificates/sso/ssoserverapache.crt -X POST ""https://HTTPD_HOST_NAME/login"" -d IDToken1=openidmtafjohn -d IDToken2=TestPassw0rd","",0,10000
Verify login to OpenIDM from SC1 by non-admin user successfully,sc1,curl,"--header ""X-Requested-With: XMLHttpRequest"" -b /tmp/openidmtafjohnTafCookie.txt --cacert /ericsson/tor/data/certificates/sso/ssoserverapache.crt --request GET  ""https://HTTPD_HOST_NAME/openidm/managed/user/openidmtafjohn""","""userName"":""openidmtafjohn""",0,10000
Verify login to OpenDJ from SC1 by non-admin user successfully,sc1,ldapsearch,"-p 1636 --useSSL --trustAll -D ""uid=openidmtafjohn,ou=people,COM_INF_LDAP_ROOT_SUFFIX"" -w TestPassw0rd -b ""ou=people,COM_INF_LDAP_ROOT_SUFFIX"" uid=openidmtafjohn","dn: uid=openidmtafjohn,ou=People",0,10000
Verify login to OpenIDM from SC1 by non-admin user to access other users' info unsuccessfully,sc1,curl,"--header ""X-Requested-With: XMLHttpRequest"" -b /tmp/openidmtafjohnTafCookie.txt --cacert /ericsson/tor/data/certificates/sso/ssoserverapache.crt --request GET  ""https://HTTPD_HOST_NAME/openidm/managed/user/administrator""","""reason"":""Forbidden""",0,10000
Verify creating new a user by non-admin user unsuccessfully,sc1,curl,"--header ""X-Requested-With: XMLHttpRequest"" -b /tmp/openidmtafjohnTafCookie.txt --cacert /ericsson/tor/data/certificates/sso/ssoserverapache.crt --request PUT --data '{""userName"":""openidmtafjohn2"", ""firstName"":""openidmtafjohn2"", ""lastName"":""smith2"", ""email"":""openidmtafjohn2@example.com"", ""password"":""TestPassw0rd"", ""userType"":""enmUser"", ""status"":""Enabled""}' https://HTTPD_HOST_NAME/openidm/managed/user/openidmtafjohn2","""reason"":""Forbidden""",0,10000
Verify non-admin user cannot update userName,sc1,curl,"--header ""X-Requested-With: XMLHttpRequest"" -b /tmp/openidmtafjohnTafCookie.txt --cacert /ericsson/tor/data/certificates/sso/ssoserverapache.crt --request POST -d '[{""replace"":""userName"", ""value"": ""openidmtafjohn2""}]' ""https://HTTPD_HOST_NAME/openidm/managed/user/openidmtafjohn?_action=patch""","""reason"":""Forbidden""",0,10000
Verify non-admin user cannot update status from SC1,sc1,curl,"--header ""X-Requested-With: XMLHttpRequest"" -b /tmp/openidmtafjohnTafCookie.txt --cacert /ericsson/tor/data/certificates/sso/ssoserverapache.crt --request POST -d '[{""replace"":""status"", ""value"": ""disabled""}]' ""https://HTTPD_HOST_NAME/openidm/managed/user/openidmtafjohn?_action=patch""","""reason"":""Forbidden""",0,10000
Verify non-admin user cannot update userType,sc1,curl,"--header ""If-Match:\""*\"""" --header ""X-Requested-With: XMLHttpRequest"" -b /tmp/openidmtafjohnTafCookie.txt --cacert /ericsson/tor/data/certificates/sso/ssoserverapache.crt --request PUT --data '{""userName"":""openidmtafjohn"", ""firstName"":""openidmtafjohn"", ""lastName"":""smith"", ""email"":""openidmtafjohn@example.com"", ""password"":""TestPassw0rd"", ""userType"":""enmNewUser"", ""status"":""enabled""}' https://HTTPD_HOST_NAME/openidm/managed/user/openidmtafjohn","""reason"":""Forbidden""",0,10000
Verify non-admin user cannot change password without re-authentication,sc1,curl,"--header ""X-Requested-With: XMLHttpRequest"" --cacert /ericsson/tor/data/certificates/sso/ssoserverapache.crt --header ""X-OpenIDM-Username:openidmtafjohn"" --header ""X-OpenIDM-New-Password: newTestPassw0rd"" --request POST ""https://HTTPD_HOST_NAME/openidm/endpoint/managePassword""","Missing credentials",0,10000
Verify non-admin user cannot update password without re-authentication from SC1,sc1,curl,"--header ""If-Match:\""*\"""" --header ""X-Requested-With: XMLHttpRequest"" -b /tmp/openidmtafjohnTafCookie.txt --cacert /ericsson/tor/data/certificates/sso/ssoserverapache.crt --request PUT --data '{""userName"":""openidmtafjohn"", ""firstName"":""openidmtafjohn"", ""lastName"":""smith"", ""email"":""openidmtafjohn@example.com"", ""password"":""newTestPassw0rd"", ""userType"":""enmUser"", ""status"":""enabled""}' https://HTTPD_HOST_NAME/openidm/managed/user/openidmtafjohn","Forbidden",0,10000
Verify non-admin user cannot change password with unsuccessful re-authentication from SC1,sc1,curl,"--header ""X-Requested-With: XMLHttpRequest"" --cacert /ericsson/tor/data/certificates/sso/ssoserverapache.crt --header ""X-OpenIDM-Username:openidmtafjohn"" --header ""X-OpenIDM-Reauth-Password:TestwrongPassw0rd"" --header ""X-OpenIDM-New-Password: TestPassw0rd1"" --request POST ""https://HTTPD_HOST_NAME/openidm/endpoint/managePassword""","Invalid user name or credentials",0,10000
Verify non-admin user cannot change password with new password short in length,sc1,curl,"--header ""X-Requested-With: XMLHttpRequest"" --cacert /ericsson/tor/data/certificates/sso/ssoserverapache.crt --header ""X-OpenIDM-Username:openidmtafjohn"" --header ""X-OpenIDM-Reauth-Password:TestPassw0rd"" --header ""X-OpenIDM-New-Password: newP0rd"" --request POST ""https://HTTPD_HOST_NAME/openidm/endpoint/managePassword""","MIN_LENGTH",0,10000
Verify non-admin user cannot change password with new password missing number,sc1,curl,"--header  ""X-Requested-With: XMLHttpRequest"" --cacert /ericsson/tor/data/certificates/sso/ssoserverapache.crt --header ""X-OpenIDM-Username:openidmtafjohn"" --header ""X-OpenIDM-Reauth-Password:TestPassw0rd"" --header ""X-OpenIDM-New-Password: newPassword"" --request POST ""https://HTTPD_HOST_NAME/openidm/endpoint/managePassword""","AT_LEAST_X_NUMBERS",0,10000
Verify non-admin user cannot change password with new password missing capital,sc1,curl,"--header ""X-Requested-With: XMLHttpRequest"" --cacert /ericsson/tor/data/certificates/sso/ssoserverapache.crt --header ""X-OpenIDM-Username:openidmtafjohn"" --header ""X-OpenIDM-Reauth-Password:TestPassw0rd"" --header ""X-OpenIDM-New-Password: newpassw0rd"" --request POST ""https://HTTPD_HOST_NAME/openidm/endpoint/managePassword""","AT_LEAST_X_CAPITAL_LETTERS",0,10000
Verify non-admin user cannot change password with new password missing small letter,sc1,curl,"--header ""X-Requested-With: XMLHttpRequest"" --cacert /ericsson/tor/data/certificates/sso/ssoserverapache.crt --header ""X-OpenIDM-Username:openidmtafjohn"" --header ""X-OpenIDM-Reauth-Password:TestPassw0rd"" --header ""X-OpenIDM-New-Password: NEWPASSW0RD"" --request POST ""https://HTTPD_HOST_NAME/openidm/endpoint/managePassword""","AT_LEAST_X_SMALL_LETTERS",0,10000
Verify non-admin user cannot change password with new password contains forbidden special character,sc1,curl,"--header ""X-Requested-With: XMLHttpRequest"" --cacert /ericsson/tor/data/certificates/sso/ssoserverapache.crt --header ""X-OpenIDM-Username:openidmtafjohn"" --header ""X-OpenIDM-Reauth-Password:TestPassw0rd"" --header ""X-OpenIDM-New-Password: newpassw0rd#"" --request POST ""https://HTTPD_HOST_NAME/openidm/endpoint/managePassword""","CANNOT_CONTAIN_CHARACTERS",0,10000
Verify non-admin user change password successfully,sc1,curl,"--header ""X-Requested-With: XMLHttpRequest"" -b /tmp/openidmtafjohnTafCookie.txt --cacert /ericsson/tor/data/certificates/sso/ssoserverapache.crt --header ""X-OpenIDM-Username:openidmtafjohn"" --header ""X-OpenIDM-Reauth-Password:TestPassw0rd"" --header ""X-OpenIDM-New-Password: newTestPassw0rd"" --request POST ""https://HTTPD_HOST_NAME/openidm/endpoint/managePassword""","",0,10000
Obtain a new cookie with new password for openidmtafjohn,sc1,curl,"-c /tmp/openidmtafjohnTafCookie2.txt --cacert /ericsson/tor/data/certificates/sso/ssoserverapache.crt -X POST ""https://HTTPD_HOST_NAME/login"" -d IDToken1=openidmtafjohn -d IDToken2=newTestPassw0rd","",0,10000
Verify failed to login to OpenDJ from SC1 by non-admin user with old password,sc1,ldapsearch,"-p 1636 --useSSL --trustAll -D ""uid=openidmtafjohn,ou=people,COM_INF_LDAP_ROOT_SUFFIX"" -w TestPassw0rd -b ""ou=people,COM_INF_LDAP_ROOT_SUFFIX"" uid=openidmtafjohn","Invalid Credentials",0,10000
Verify login to OpenIDM from SC1 by non-admin user with new password successfully,sc1,curl,"--header ""X-Requested-With: XMLHttpRequest"" -b /tmp/openidmtafjohnTafCookie2.txt --cacert /ericsson/tor/data/certificates/sso/ssoserverapache.crt --request GET  ""https://HTTPD_HOST_NAME/openidm/managed/user/openidmtafjohn""","""userName"":""openidmtafjohn""",0,10000
Verify login to OpenDJ from SC1 by non-admin user with new password successfully,sc1,ldapsearch,"-p 1636 --useSSL --trustAll -D ""uid=openidmtafjohn,ou=people,COM_INF_LDAP_ROOT_SUFFIX"" -w newTestPassw0rd -b ""ou=people,COM_INF_LDAP_ROOT_SUFFIX"" uid=openidmtafjohn","dn: uid=openidmtafjohn,ou=People",0,10000
